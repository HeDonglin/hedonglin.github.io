---
title: vps搭建与设置
date: 2017-06-19 11:13:09
categories: 服务器
tags: vps
---
## 服务器分类
### 虚拟服务器
把一台物理机器分割成很多的小空间，这些空间共享操作系统的资源，比如：同一个操作系统，同一个IP，但是是不同的域名，共享带宽，共享服务器的资源（CPU、内存、存储空间）
**vps主机**：(推荐)VPS通过一定的技术将一台物理机分割成若干台服务器，每一台都具有独立的操作系统和独立的IP；独立的CPU、内存、存储空间，可自行安装程序，单独重启自己的VPS，VPS主机每个虚拟服务器都有自己独立的Root/Administrator管理权限，除用户的管理账户，其他人无权限看到主机上的数据。
**独立服务器**：界于VPS和云主机之间，VPS对于客户的隔离效果差，虽然有分配的CPU、内存等独立资源，但是受制于单机的CPU、内存等。单独的服务器有自己独立的CPU、内存，可以进行简单的备份（不如专业的云存储）。但是易于单独的数据迁移。
**云主机**：首先云基于的是计算机的分布式的连接（很多的服务器连接在一起，共同进行计算），并且它的存储是碎片化的存储，很有可能每台机器上都有某个用户的数据，如果运行中时突然有服务器宕机，云主机会将计算转移到其他的机器上，保证几乎零宕机。
1. **独享云虚拟主机**：独享资源，空间超大，不限流量，更高配置，企业建站首选。
2. **共享云虚拟主机**：资源共享，空间较大，固定流量，经济实惠，满足基本建站。
3. **云服务器ECS** ：是一种弹性计算服务，支持各种应用软件灵活扩展，需要有专业技术人员来维护。

### 物理服务器
物理服务器的构成包括处理器、硬盘、内存、系统总线等，和通用的计算机架构类似，但是由于需要提供高可靠的服务，因此在处理能力、稳定性、可靠性、安全性、可扩展性、可管理性等方面要求较高。物理服务器在购买之后，还需要机房、UPS、空调等设备，还有后期的运维费用，这些都需要考虑的。
*****

## vps服务器的搭建
搬瓦工<https://bwh1.net>是IT7旗下站点，主营超低价年付openvz架构vps业务。其VPS长期以来以稳定著称，在国内用户中颇有口碑。目前搬瓦工VPS有八个数据中心，可支持支付宝付款。
<img src="/images/vps-1.png" alt="vps-1.png">
<img src="/images/vps-2.png" alt="vps-2.png">
**购买服务器需要注意**
* US: New York [USNY_2] `纽约`
* US: Los Angeles, California (DC1 QNET) [USCA_2] (current) `加州洛杉矶2` （首选）
* US: Los Angeles, California (DC2 MCOM) [USCA_4] `加州洛杉矶4`（次选）
* US: Fremont, California [USCA_FMT] `加州弗里蒙特`
* US: Phoenix, Arizona [USAZ_2] `凤凰城`
* US: Jacksonville, Florida [USFL_2] `佛罗里达`
* EU: Amsterdam, Netherlands [EUNL_3] `荷兰`
* CA: British Columbia, Vancouver [CABC_1] `温哥华`

<img src="/images/vps-3.png" alt="vps-3.png">
**优惠码：**
`IAMSMART5TDT48` 5.08%
`IAMSMART5YA8FO` - 3.91%
<img src="/images/vps-4.png" alt="vps-4.png">
<img src="/images/vps-5.png" alt="vps-5.png">
<img src="/images/vps-6.png" alt="vps-6.png">
*****

## 进入控制面板后台
<img src="/images/vps-7.png" alt="vps-7.png">
<img src="/images/vps-8.png" alt="vps-8.png">
<img src="/images/vps-9.png" alt="vps-9.png">
<img src="/images/vps-10.png" alt="vps-10.png">
*****

## 控制面板中文含义
```js
Main controls:
    physical location --机房
    ip address--ip地址
    SSH port--端口
    status--运行状态
    actions--操作
    RAM--内存
    SWAP--突发内存
    Disk usage--硬盘
    operating system--系统(默认centos 6 x86)
    hostname--主机名称
    Reverse DNS--反向域名解析
ipv6 Addresses-ipv6 地址
Detailed statistics-信息和状态:查看主机当前和最近的内存，负载，网络，IO进程等等信息
File Manager-文件管理
Root shell-basic-基础root命令窗口,在这里可以直接命令操作vps
Root shell-advanced-进阶命令窗口,输入或粘贴多个命令,ctrl+enter将提交表单
Root shell-interactive root互动,点击launch按键后会进入一个类似于vnc的窗口和putty差不多,可以直接对vps进行操作
install new os 重装系统:
    版本系列划分:ubuntu (debian系列)
                 Reahat系列(RedHat,CentOS,Fedora)
    版本按功能划分:桌面版-->Ubuntu(推荐使用LinuxMint)
                            Fedora
                    服务版-->CentOS(推荐使用CentOS)
                            RedHat
                            Ubuntu也有Server版本
two-factor authentication 手机安全验证
root password modification 点击按钮自动生成随机的root密码
kiwiVM password modification 修改kiwivm面板的登录的密码账号是ip地址和密码
Migration:Migrate to another DC 切换机房/换ip
          Migrate from another server 两个服务器进行数据迁移
KiwiVM Extras
    API api开发接口
    snapshots 用于备份目的创建vps的一个副本,存储30天
    openVPN server VPN代理将根据地理位置转换服务器IP段，即实现本土IP变换成国外IP段。open服务器,　VPN直译就是虚拟专用通道，是提供给企业之间或者个人与公司之间安全数据传输的隧道(可以翻墙),也可以说在公用网络上建立专用网络，进行加密通讯。
```
*****

## 下载Xshell工具本地远程控制服务器
***安装时选择：免费为家庭/学校即可***
```javascript
xshell下载地址：http://www.dayanzai.me/xshell.html
kiwivm面板：https://kiwivm.64clouds.com/
登录：服务器ip地址
密码为：登录账户时的密码
填写kiwivm面板里main controls里的信息
新建回话-ssh端口号：
         ip地址：
         用户名：root
         密码：kiwivm面板root password modification 里随机生成的密码；
```
*****

## kangle（kangle web服务器）是一款跨平台、功能强大、安全稳定、易操作的高性能web服务器和反向代理服务器软件。
```js
kangle服务器
    (默认)php5.3 版本
    easypanel 2.6.18 版本
    (一般很少用)独立网站管理登录http://ip地址:3312/vhost
    (经常使用)管理面板登录http://ip地址:3312/admin
        第一次进入,在账号管理修改账号和密码;
        用户名(默认,admin):
        密码(默认,kangle):
    kangle 3.5.7 版本
        http://ip地址:3311或者在easypanel的服务器信息进行登录
        第一次进入可在配置管理选项设置新的账号和密码;
        用户名(默认,admin):
        密码(默认,kangle):
    mysql数据库密码
        登录http://ip地址:3313/mysql/或者在easypanel上mysql管理进行登录
        用户名(在easypanel上服务器设置):
        密码(在easypanel上的服务器设置):
        mysql中root密码需要在最高权限计算机下设置mysqladmin -u root password "密码";
```
*****

## 安装系统,一键安装kangle服务器,php,mysql
```js
官网镜像https://bwh1.net
更换系统:centos-6-x86_64-minimal(此版本为精简版(少了一些不必要的软件)更换的时候会提示等待1分钟左右吧)
root账号密码:kiwivm面板上设置点击即可随机生成
ssh端口号:
安装系统后:
    安装remi源:rpm -Uvh http://rpms.famillecollet.com/enterprise/remi-release-6.rpm  
    安装kangle+php5.3+mysql命令:yum -y install wget;wget http://download.kanglesoft.com/easypanel/ep.sh -O ep.sh;sh ep.sh 
更新:yum update -y
mysqladmin -u root password "密码" 修改mysql的root密码
服务器设置:只需修改第二行,mysql数据库,然后填写端口3306,主机localhost;mysql用户名(注意要使用最高权限):root,网站密码,端口为3306
        服务器管理 --> 初始化服务器
安装php最新插件:php5.5和php7.0(5.6版本有问题不安装)
kangle中php位置
    /vhs/kangle/ext/tpl_php52
卸载方法
    rm -rf /vhs/kangle/ext/tpl_php5532/
用命令安装所需要的php版本(任意一个或多个)
【php插件】kangle easypanel面板 php-5.2.17 for linux版 (集成zend和ioncube)
http://bbs.itzmx.com/thread-7803-1-1.html
wget http://github.itzmx.com/1265578519/kangle/master/php/5.2/5217/php5217.sh -O php5217.sh;sh php5217.sh
【php插件】kangle easypanel面板 php-5.6.24 for linux版 支持ioncube 与Zend OPcache
http://bbs.itzmx.com/thread-9064-1-1.html
wget http://github.itzmx.com/1265578519/kangle/master/php/5.6/5624/php5624.sh -O php5624.sh;sh php5624.sh   
【php插件】kangle easypanel面板 php-5.5.38 for linux版 支持ioncube与Zend OPcache
http://bbs.itzmx.com/thread-9112-1-1.html
wget http://github.itzmx.com/1265578519/kangle/master/php/5.5/5538/php5538.sh -O php5538.sh;sh php5538.sh
【php插件】kangle easypanel面板 php-5.4.45 for linux版 (集成支持zend和ioncube)
http://bbs.itzmx.com/thread-9111-1-1.html
wget http://github.itzmx.com/1265578519/kangle/master/php/5.4/5445/php5445.sh -O php5445.sh;sh php5445.sh
【php插件】kangle easypanel面板 php-7.0.9 for linux版 支持ioncube 与Zend OPcache
http://bbs.itzmx.com/thread-10415-1-1.html
wget http://github.itzmx.com/1265578519/kangle/master/php/7.0/709/php709.sh -O php709.sh;sh php709.sh
升级kangle easypanel面板的php 5.3.21版本到5.6.24来修复PHP DOS漏洞
http://bbs.itzmx.com/thread-9202-1-1.html
rm -rf /vhs/kangle/ext/tpl_php52/config.xml
wget http://github.itzmx.com/1265578519/kangle/master/easypanel/config.xml -O /vhs/kangle/ext/tpl_php52/config.xml
wget http://github.itzmx.com/1265578519/kangle/master/easypanel/php-node-5624.ini -O /vhs/kangle/ext/tpl_php52/etc/php-node-5624.ini
/vhs/kangle/bin/kangle -r
网站管理-->新增网站
安装完php后,要以无格式设置新建网站
```
*****

## Shadowsocks Server vpn设置
```js
官网镜像:https://bwh1.net
登录名:邮箱地址
密码:个人密码
进入services-->my services -->kiwivm control panel-->获取以下信息;
ip:购买时的服务商提供的ip地址
ssh:对应的ssh端口
vpn加密方式:aes-256-cfb
vpn端口:对应的vpn端口
vpn密码:(随机生成)

编辑服务器软件(shadowsocks)
    服务器ip地址:
    服务器端口:
    密码:vpn密码
    加密:vpn加密
    代理端口:1080

结合kcptun使用的配置
    服务器ip地址(填写本地):127.0.0.1
    服务器端口:443
    密码:vpn密码
    加密:vpn加密
    代理端口:1080
```
*****

## kcptun如何加速访问网络速度
在Xshell ***每复制一行粘贴一行接着回车*** 压缩保持默认，加速端口和密码可以修改加密方式可以设置，以下为服务端进行安装设置，获取到配置信息，最后填入客户端上即可
```js
wget https://raw.githubusercontent.com/kuoruan/kcptun_installer/master/kcptun.sh
chmod +x ./kcptun.sh
./kcptun.sh
以下内容为上述的详细描述
开始设置防火墙...
UDP 端口 29900 已开放!
firewalld 未安装, 跳过配置
正在清理无用文件...
正在获取当前安装的 Kcptun 信息...
配置信息
！！！注意此处获取配置信息，复制出来在客户端上使用
当前安装的 Kcptun 版本为: 20161222
请前往 https://github.com/xtaci/kcptun/releases/tag/v20161222 手动下载客户端文件
```
*****

## 客户端上设置kcptun
```js
kcptun_gclient.exe--Kcptun启动工具
https://github.com/dfdragon/kcptun_gclient/releases
client_windows_amd64.exe--Kcptun客户端程序 
server_windows_amd64.exe--Kcptun服务端程序
https://github.com/xtaci/kcptun/releases/tag/v20161222
配置信息：
kcptun客户端exe文件：D:\Program Files\kcptun64\client_windows_amd64.exe
使用配置文件：D:\Program Files\kcptun64\server-config.json
第一种选择：主要设置以下几点其他都默认即可
服务器IP:  IP地址 
端口:  29900 
加速地址: 127.0.0.1
加速端口: 443
密码:  密码 
crypt:  none 
mode:  fast2 
第二种选择：可使用的客户端配置文件为:
直接把刚才在服务器上复制出来的拷贝在D:\Program Files\kcptun64\server-config.json上即可
最后Shadowsocks Server vpn设置上结合的配置
```
*****

## kcptun服务端命令
```js
请使用: ./kcptun.sh <option>
可使用的参数 <option> 包括:
    install          安装
    uninstall        卸载
    update           检查更新
    manual           自定义 Kcptun 版本安装
    help             查看脚本使用说明
    add              添加一个实例, 多用户使用
    reconfig <id>    重新配置实例
    show <id>        显示实例详细配置
    log <id>         显示实例日志
注: 上述参数中的 <id> 可选, 代表的是实例的序号
    可使用 1, 2, 3 ... 分别对应 kcptun, kcptun2, kcptun3 ...
    若不指定 <id>, 则默认为 1
Supervisor 命令:
    service supervisord {start|stop|restart|status}
                        {启动|关闭|重启|查看状态}
Kcptun 相关命令:
    supervisorctl {start|stop|restart|status} kcptun<id>
                  {启动|关闭|重启|查看状态}
service supervisord start
supervisorctl start kcptun
```
