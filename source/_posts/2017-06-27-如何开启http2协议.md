---
title: 如何开启http2协议
date: 2017-06-27 10:56:27
categories: 服务器
tags: http2
---
## 开启模块（目前这一步失败，搞不懂）

```js
yum -y install which file wget make automake gcc gcc-c++ pcre-devel zlib-devel openssl-devel sqlite-devel quota unzip bzip2
ulimit -n 1048576
echo "* soft nofile 1048576" >> /etc/security/limits.conf
echo "* hard nofile 1048576" >> /etc/security/limits.conf
wget http://download.kangleweb.com/devel.php?os=src -O kangle.tar.gz
tar xzf kangle.tar.gz
cd kangle-*
./configure --prefix=/vhs/kangle --enable-vh-limit --enable-disk-cache --enable-ipv6 --enable-ssl --enable-http2
make -j 4
make install
/vhs/kangle/bin/kangle
echo "/vhs/kangle/bin/kangle" >> /etc/rc.d/rc.local
```

## 协议切换（已成功）
2016年5月31号之前chrome采用NPN(下一代协议协商)
2016年5月31号之后chrome采用ALPN(应用层协议协商)
OpenSSL 1.0.1 的支持将于 2016-12-31 停止
从NPN迁移到ALPN，服务器要支持 ALPN，必须开启OpenSSL 1.0.2
一键安装命令
```js
cd ~
wget http://www.openssl.org/source/openssl-1.0.2h.tar.gz
tar -zxvf openssl-1.0.2h.tar.gz
cd openssl-1.0.2h
./config shared zlib
make
make test
make install
rm -rf /usr/bin/openssl.OFF
mv /usr/bin/openssl /usr/bin/openssl.OFF
rm -rf /usr/include/openssl.OFF
mv /usr/include/openssl /usr/include/openssl.OFF
ln -s /usr/local/ssl/bin/openssl /usr/bin/openssl
ln -s /usr/local/ssl/include/openssl /usr/include/openssl
echo "/usr/local/ssl/lib" >> /etc/ld.so.conf
ldconfig -v
openssl version
```
